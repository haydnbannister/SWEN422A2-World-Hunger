<html>
       <head>
        <meta charset="utf-8">
        <link href="/d3-geomap/css/d3.geomap.css" rel="stylesheet">
        <script src="/d3-geomap/vendor/d3.geomap.dependencies.min.js"></script>
        <script src="/d3-geomap/js/d3.geomap.min.js"></script>
    </head>
    <body>
        <div id="map"></div>
    </body>
    
    <script>
    // write your d3 code here.. 
    
    // python -m http.server 8000
    // python -m SimpleHTTPServer 8000
    // http://localhost:8000/World_Chloropleth.html
    
    //Who are we presenting the data
    var year = '2000';
    var percent = true;
    
    //The formates
    var percentFormat = function(d) {
    d = d / 1;
    return d3.format(',.02f')(d) + '%';
    }

    var millionsFormat = function(d) {
    d = d / 1;
    return d3.format(',.02f')(d) + ' millions of straving people';
    }
    
    //Make the cholorpleth
    var worldmap = d3.geomap.choropleth()
    .geofile('/d3-geomap/topojson/world/countries.json')
    .colors(colorbrewer.YlOrRd[9])
    .column('Percent')
    .format(percentFormat)
    .legend(true)
    .unitId('iso3');

    loadData();
    
    //Loads the data
    function loadData(){
        d3.csv('Data/'+ year +'.csv', function(error, data) {
            var selection = d3.select('#map').datum(data);
            worldmap.draw(selection);
        });
    }
    
    //Set the year to a different value
    function setYear(newYear){
        this.year = newYear;
        //Refresh
        loadData();
    }
    
    //Toggles between precent of straving people and number of straving people
    function toggleFormate(){
        percent = !percent;
        
        if(percent){
            worldmap.column('Percent').format(percentFormat);
        }else{
            worldmap.column('Millions').format(millionsFormat);
        }
        //Refresh
        loadData();
    }
    
    
    </script>
</html>
